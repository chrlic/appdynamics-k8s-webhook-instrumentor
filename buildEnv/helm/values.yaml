
serviceaccount: webhook-instrumentor
deploymentName: webhook-server
webhookName: webhook-appd
# namespacesEnabled is optional list of namespaces, where webhook would be applied. 
# If missing, all namespaces will be enabled, except kubernetes system namespaces
# namespacesEnabled:
# - ns1
# - ns2
# namespacesDisabled is optional list of namespaces, where webhook would not be applied. 
# If missing, all namespaces will be enabled, except kubernetes system namespaces 
# (and namespace where the webook itself is running)
# namespacesDisabled:
# - ns3
# number of replicas for webhook server
replicas: 1

# service type and port for webhook server
service:
  type: ClusterIP
  port: 443

image:
  image: docker.io/chrlic/appd-webhook-instrumentor:v1.0.2
  pullPolicy: Always

appdController:
#  host: 192.168.227.132
#  port: "8090"
#  isSecure: false
#  accountName: customer1
#  accessKey: "0df071e7-6517-4444-b5bf-ff51e1532533"
  host: ceer.saas.appdynamics.com
  port: "443"
  isSecure: true
  accountName: ceer
  accessKey: "3gnmajormowm"
  useProxy: true
  proxyHost: proxy.esl.cisco.com
  proxyPort: "80"


instrumentationTemplates:
  - name: Java_Default
    injectionRules:
      technology: java
      image: appdynamics/java-agent:latest
      javaEnvVar: JAVA_TOOL_OPTIONS
      applicationNameSource: label
      applicationNameLabel: appdApp
      tierNameSource: auto
  - name: Dotnet_Default
    injectionRules:
      technology: dotnetcore
      image: appdynamics/dotnet-core-agent:22.5.1
      applicationNameSource: label
      applicationNameLabel: appdApp
      tierNameSource: auto
  - name: Nodejs_Default
    injectionRules:
      technology: dotnetcore
      image: appdynamics/nodejs-agent:22.5.0-16-stretch-slim
      applicationNameSource: label
      applicationNameLabel: appdApp
      tierNameSource: auto

instrumentationRules:
  - name: test1
    matchRules:
      namespaceRegex: .*
      labels:
      - matchLabel: test1
      - language: java
      annotations:
      - annot1: .*
      podNameRegex: .*
    injectionRules:
      technology: java
      image: appdynamics/java-agent:latest
      javaEnvVar: _JAVA_OPTIONS
  - name: test2
    matchRules:
      namespaceRegex: .*
      labels:
      - appdInstr: do
      - language: java
      podNameRegex: .*
    injectionRules:
      template: Java_Default
      technology: java
      image: appdynamics/java-agent:latest
      javaEnvVar: _JAVA_OPTIONS
  - name: dotnet1
    matchRules:
      namespaceRegex: .*
      labels:
      - appdInstr: do
      - language: dotnetcore
      podNameRegex: .*
    injectionRules:
      template: Dotnet_Default
  - name: nodejs1
    matchRules:
      namespaceRegex: .*
      labels:
      - appdInstr: do
      - language: nodejs
      podNameRegex: .*
    injectionRules:
      template: Nodejs_Default

